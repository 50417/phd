# This package contains C++ binaries for calling from CLgen python code.

# The rather ludicrous combination of data, of copts and linkopts is a result
# of bashing my head against the wall for a few days trying to get the damn
# things to compile and link against a remote LLVM binary release. The
# abomination of options below works as of the time of writing (2018-06-12).
# This is *definitely* not the best way to do it, but it's the only way I
# could get it work given the seemingly picky ordering of LLVM link libraries,
# and the sandboxing of bazel's build.

cc_binary(
    name = "clgen-features",
    srcs = ["clgen-features.cpp"],
    copts = [
        "-fPIC",
        "-fvisibility-inlines-hidden",
        "-Werror=date-time",
        "-std=c++11",
        "-Wall",
        "-W",
        "-Wno-unused-parameter",
        "-Wwrite-strings",
        "-Wcast-qual",
        "-Wno-missing-field-initializers",
        "-pedantic",
        "-Wno-long-long",
        "-Wdelete-non-virtual-dtor",
        "-Wno-comment",
        "-fno-rtti",
        "-ffunction-sections",
        "-fdata-sections",
        "-DNDEBUG",
        "-D_GNU_SOURCE",
        "-D__STDC_CONSTANT_MACROS",
        "-D__STDC_FORMAT_MACROS",
        "-D__STDC_LIMIT_MACROS",
    ],
    data = select({
        "//:darwin": [
            "@llvm_mac//:libdir",
            "@llvm_mac//:lib_clangARCMigrate",
            "@llvm_mac//:lib_clangFrontend",
            "@llvm_mac//:lib_clangFrontendTool",
            "@llvm_mac//:lib_clangDriver",
            "@llvm_mac//:lib_clangSerialization",
            "@llvm_mac//:lib_clangCodeGen",
            "@llvm_mac//:lib_clangParse",
            "@llvm_mac//:lib_clangSema",
            "@llvm_mac//:lib_clangRewriteFrontend",
            "@llvm_mac//:lib_clangRewrite",
            "@llvm_mac//:lib_clangStaticAnalyzerFrontend",
            "@llvm_mac//:lib_clangStaticAnalyzerCheckers",
            "@llvm_mac//:lib_clangStaticAnalyzerCore",
            "@llvm_mac//:lib_clangAnalysis",
            "@llvm_mac//:lib_clangEdit",
            "@llvm_mac//:lib_clangAST",
            "@llvm_mac//:lib_clangASTMatchers",
            "@llvm_mac//:lib_clangLex",
            "@llvm_mac//:lib_clangBasic",
            "@llvm_mac//:lib_clangTooling",
            "@llvm_mac//:lib_clangToolingCore",
            "@llvm_mac//:lib_LLVMLTO",
            "@llvm_mac//:lib_LLVMPasses",
            "@llvm_mac//:lib_LLVMObjCARCOpts",
            "@llvm_mac//:lib_LLVMMIRParser",
            "@llvm_mac//:lib_LLVMSymbolize",
            "@llvm_mac//:lib_LLVMDebugInfoPDB",
            "@llvm_mac//:lib_LLVMDebugInfoDWARF",
            "@llvm_mac//:lib_LLVMCoverage",
            "@llvm_mac//:lib_LLVMTableGen",
            "@llvm_mac//:lib_LLVMDlltoolDriver",
            "@llvm_mac//:lib_LLVMOrcJIT",
            "@llvm_mac//:lib_LLVMXCoreDisassembler",
            "@llvm_mac//:lib_LLVMXCoreCodeGen",
            "@llvm_mac//:lib_LLVMXCoreDesc",
            "@llvm_mac//:lib_LLVMXCoreInfo",
            "@llvm_mac//:lib_LLVMXCoreAsmPrinter",
            "@llvm_mac//:lib_LLVMSystemZDisassembler",
            "@llvm_mac//:lib_LLVMSystemZCodeGen",
            "@llvm_mac//:lib_LLVMSystemZAsmParser",
            "@llvm_mac//:lib_LLVMSystemZDesc",
            "@llvm_mac//:lib_LLVMSystemZInfo",
            "@llvm_mac//:lib_LLVMSystemZAsmPrinter",
            "@llvm_mac//:lib_LLVMSparcDisassembler",
            "@llvm_mac//:lib_LLVMSparcCodeGen",
            "@llvm_mac//:lib_LLVMSparcAsmParser",
            "@llvm_mac//:lib_LLVMSparcDesc",
            "@llvm_mac//:lib_LLVMSparcInfo",
            "@llvm_mac//:lib_LLVMSparcAsmPrinter",
            "@llvm_mac//:lib_LLVMPowerPCDisassembler",
            "@llvm_mac//:lib_LLVMPowerPCCodeGen",
            "@llvm_mac//:lib_LLVMPowerPCAsmParser",
            "@llvm_mac//:lib_LLVMPowerPCDesc",
            "@llvm_mac//:lib_LLVMPowerPCInfo",
            "@llvm_mac//:lib_LLVMPowerPCAsmPrinter",
            "@llvm_mac//:lib_LLVMNVPTXCodeGen",
            "@llvm_mac//:lib_LLVMNVPTXDesc",
            "@llvm_mac//:lib_LLVMNVPTXInfo",
            "@llvm_mac//:lib_LLVMNVPTXAsmPrinter",
            "@llvm_mac//:lib_LLVMMSP430CodeGen",
            "@llvm_mac//:lib_LLVMMSP430Desc",
            "@llvm_mac//:lib_LLVMMSP430Info",
            "@llvm_mac//:lib_LLVMMSP430AsmPrinter",
            "@llvm_mac//:lib_LLVMMipsDisassembler",
            "@llvm_mac//:lib_LLVMMipsCodeGen",
            "@llvm_mac//:lib_LLVMMipsAsmParser",
            "@llvm_mac//:lib_LLVMMipsDesc",
            "@llvm_mac//:lib_LLVMMipsInfo",
            "@llvm_mac//:lib_LLVMMipsAsmPrinter",
            "@llvm_mac//:lib_LLVMLanaiDisassembler",
            "@llvm_mac//:lib_LLVMLanaiCodeGen",
            "@llvm_mac//:lib_LLVMLanaiAsmParser",
            "@llvm_mac//:lib_LLVMLanaiDesc",
            "@llvm_mac//:lib_LLVMLanaiAsmPrinter",
            "@llvm_mac//:lib_LLVMLanaiInfo",
            "@llvm_mac//:lib_LLVMHexagonDisassembler",
            "@llvm_mac//:lib_LLVMHexagonCodeGen",
            "@llvm_mac//:lib_LLVMHexagonAsmParser",
            "@llvm_mac//:lib_LLVMHexagonDesc",
            "@llvm_mac//:lib_LLVMHexagonInfo",
            "@llvm_mac//:lib_LLVMBPFDisassembler",
            "@llvm_mac//:lib_LLVMBPFCodeGen",
            "@llvm_mac//:lib_LLVMBPFAsmParser",
            "@llvm_mac//:lib_LLVMBPFDesc",
            "@llvm_mac//:lib_LLVMBPFInfo",
            "@llvm_mac//:lib_LLVMBPFAsmPrinter",
            "@llvm_mac//:lib_LLVMARMDisassembler",
            "@llvm_mac//:lib_LLVMARMCodeGen",
            "@llvm_mac//:lib_LLVMARMAsmParser",
            "@llvm_mac//:lib_LLVMARMDesc",
            "@llvm_mac//:lib_LLVMARMInfo",
            "@llvm_mac//:lib_LLVMARMAsmPrinter",
            "@llvm_mac//:lib_LLVMARMUtils",
            "@llvm_mac//:lib_LLVMAMDGPUDisassembler",
            "@llvm_mac//:lib_LLVMAMDGPUCodeGen",
            "@llvm_mac//:lib_LLVMAMDGPUAsmParser",
            "@llvm_mac//:lib_LLVMAMDGPUDesc",
            "@llvm_mac//:lib_LLVMAMDGPUInfo",
            "@llvm_mac//:lib_LLVMAMDGPUAsmPrinter",
            "@llvm_mac//:lib_LLVMAMDGPUUtils",
            "@llvm_mac//:lib_LLVMAArch64Disassembler",
            "@llvm_mac//:lib_LLVMAArch64CodeGen",
            "@llvm_mac//:lib_LLVMAArch64AsmParser",
            "@llvm_mac//:lib_LLVMAArch64Desc",
            "@llvm_mac//:lib_LLVMAArch64Info",
            "@llvm_mac//:lib_LLVMAArch64AsmPrinter",
            "@llvm_mac//:lib_LLVMAArch64Utils",
            "@llvm_mac//:lib_LLVMObjectYAML",
            "@llvm_mac//:lib_LLVMLibDriver",
            "@llvm_mac//:lib_LLVMOption",
            "@llvm_mac//:lib_LLVMWindowsManifest",
            "@llvm_mac//:lib_LLVMFuzzMutate",
            "@llvm_mac//:lib_LLVMX86Disassembler",
            "@llvm_mac//:lib_LLVMX86AsmParser",
            "@llvm_mac//:lib_LLVMX86CodeGen",
            "@llvm_mac//:lib_LLVMGlobalISel",
            "@llvm_mac//:lib_LLVMSelectionDAG",
            "@llvm_mac//:lib_LLVMAsmPrinter",
            "@llvm_mac//:lib_LLVMDebugInfoCodeView",
            "@llvm_mac//:lib_LLVMDebugInfoMSF",
            "@llvm_mac//:lib_LLVMX86Desc",
            "@llvm_mac//:lib_LLVMMCDisassembler",
            "@llvm_mac//:lib_LLVMX86Info",
            "@llvm_mac//:lib_LLVMX86AsmPrinter",
            "@llvm_mac//:lib_LLVMX86Utils",
            "@llvm_mac//:lib_LLVMMCJIT",
            "@llvm_mac//:lib_LLVMLineEditor",
            "@llvm_mac//:lib_LLVMInterpreter",
            "@llvm_mac//:lib_LLVMExecutionEngine",
            "@llvm_mac//:lib_LLVMRuntimeDyld",
            "@llvm_mac//:lib_LLVMCodeGen",
            "@llvm_mac//:lib_LLVMTarget",
            "@llvm_mac//:lib_LLVMCoroutines",
            "@llvm_mac//:lib_LLVMipo",
            "@llvm_mac//:lib_LLVMInstrumentation",
            "@llvm_mac//:lib_LLVMVectorize",
            "@llvm_mac//:lib_LLVMScalarOpts",
            "@llvm_mac//:lib_LLVMLinker",
            "@llvm_mac//:lib_LLVMIRReader",
            "@llvm_mac//:lib_LLVMAsmParser",
            "@llvm_mac//:lib_LLVMInstCombine",
            "@llvm_mac//:lib_LLVMTransformUtils",
            "@llvm_mac//:lib_LLVMBitWriter",
            "@llvm_mac//:lib_LLVMAnalysis",
            "@llvm_mac//:lib_LLVMProfileData",
            "@llvm_mac//:lib_LLVMObject",
            "@llvm_mac//:lib_LLVMMCParser",
            "@llvm_mac//:lib_LLVMMC",
            "@llvm_mac//:lib_LLVMBitReader",
            "@llvm_mac//:lib_LLVMCore",
            "@llvm_mac//:lib_LLVMBinaryFormat",
            "@llvm_mac//:lib_LLVMSupport",
            "@llvm_mac//:lib_LLVMDemangle",
        ],
        "//conditions:default": [
            "@llvm_linux//:libclang_so",
            "@llvm_linux//:libdir",
            "@llvm_linux//:lib_clangARCMigrate",
            "@llvm_linux//:lib_clangFrontend",
            "@llvm_linux//:lib_clangFrontendTool",
            "@llvm_linux//:lib_clangDriver",
            "@llvm_linux//:lib_clangSerialization",
            "@llvm_linux//:lib_clangCodeGen",
            "@llvm_linux//:lib_clangParse",
            "@llvm_linux//:lib_clangSema",
            "@llvm_linux//:lib_clangRewriteFrontend",
            "@llvm_linux//:lib_clangRewrite",
            "@llvm_linux//:lib_clangStaticAnalyzerFrontend",
            "@llvm_linux//:lib_clangStaticAnalyzerCheckers",
            "@llvm_linux//:lib_clangStaticAnalyzerCore",
            "@llvm_linux//:lib_clangAnalysis",
            "@llvm_linux//:lib_clangEdit",
            "@llvm_linux//:lib_clangAST",
            "@llvm_linux//:lib_clangASTMatchers",
            "@llvm_linux//:lib_clangLex",
            "@llvm_linux//:lib_clangBasic",
            "@llvm_linux//:lib_clangTooling",
            "@llvm_linux//:lib_clangToolingCore",
            "@llvm_linux//:lib_LLVMLTO",
            "@llvm_linux//:lib_LLVMPasses",
            "@llvm_linux//:lib_LLVMObjCARCOpts",
            "@llvm_linux//:lib_LLVMMIRParser",
            "@llvm_linux//:lib_LLVMSymbolize",
            "@llvm_linux//:lib_LLVMDebugInfoPDB",
            "@llvm_linux//:lib_LLVMDebugInfoDWARF",
            "@llvm_linux//:lib_LLVMCoverage",
            "@llvm_linux//:lib_LLVMTableGen",
            "@llvm_linux//:lib_LLVMDlltoolDriver",
            "@llvm_linux//:lib_LLVMOrcJIT",
            "@llvm_linux//:lib_LLVMXCoreDisassembler",
            "@llvm_linux//:lib_LLVMXCoreCodeGen",
            "@llvm_linux//:lib_LLVMXCoreDesc",
            "@llvm_linux//:lib_LLVMXCoreInfo",
            "@llvm_linux//:lib_LLVMXCoreAsmPrinter",
            "@llvm_linux//:lib_LLVMSystemZDisassembler",
            "@llvm_linux//:lib_LLVMSystemZCodeGen",
            "@llvm_linux//:lib_LLVMSystemZAsmParser",
            "@llvm_linux//:lib_LLVMSystemZDesc",
            "@llvm_linux//:lib_LLVMSystemZInfo",
            "@llvm_linux//:lib_LLVMSystemZAsmPrinter",
            "@llvm_linux//:lib_LLVMSparcDisassembler",
            "@llvm_linux//:lib_LLVMSparcCodeGen",
            "@llvm_linux//:lib_LLVMSparcAsmParser",
            "@llvm_linux//:lib_LLVMSparcDesc",
            "@llvm_linux//:lib_LLVMSparcInfo",
            "@llvm_linux//:lib_LLVMSparcAsmPrinter",
            "@llvm_linux//:lib_LLVMPowerPCDisassembler",
            "@llvm_linux//:lib_LLVMPowerPCCodeGen",
            "@llvm_linux//:lib_LLVMPowerPCAsmParser",
            "@llvm_linux//:lib_LLVMPowerPCDesc",
            "@llvm_linux//:lib_LLVMPowerPCInfo",
            "@llvm_linux//:lib_LLVMPowerPCAsmPrinter",
            "@llvm_linux//:lib_LLVMNVPTXCodeGen",
            "@llvm_linux//:lib_LLVMNVPTXDesc",
            "@llvm_linux//:lib_LLVMNVPTXInfo",
            "@llvm_linux//:lib_LLVMNVPTXAsmPrinter",
            "@llvm_linux//:lib_LLVMMSP430CodeGen",
            "@llvm_linux//:lib_LLVMMSP430Desc",
            "@llvm_linux//:lib_LLVMMSP430Info",
            "@llvm_linux//:lib_LLVMMSP430AsmPrinter",
            "@llvm_linux//:lib_LLVMMipsDisassembler",
            "@llvm_linux//:lib_LLVMMipsCodeGen",
            "@llvm_linux//:lib_LLVMMipsAsmParser",
            "@llvm_linux//:lib_LLVMMipsDesc",
            "@llvm_linux//:lib_LLVMMipsInfo",
            "@llvm_linux//:lib_LLVMMipsAsmPrinter",
            "@llvm_linux//:lib_LLVMLanaiDisassembler",
            "@llvm_linux//:lib_LLVMLanaiCodeGen",
            "@llvm_linux//:lib_LLVMLanaiAsmParser",
            "@llvm_linux//:lib_LLVMLanaiDesc",
            "@llvm_linux//:lib_LLVMLanaiAsmPrinter",
            "@llvm_linux//:lib_LLVMLanaiInfo",
            "@llvm_linux//:lib_LLVMHexagonDisassembler",
            "@llvm_linux//:lib_LLVMHexagonCodeGen",
            "@llvm_linux//:lib_LLVMHexagonAsmParser",
            "@llvm_linux//:lib_LLVMHexagonDesc",
            "@llvm_linux//:lib_LLVMHexagonInfo",
            "@llvm_linux//:lib_LLVMBPFDisassembler",
            "@llvm_linux//:lib_LLVMBPFCodeGen",
            "@llvm_linux//:lib_LLVMBPFAsmParser",
            "@llvm_linux//:lib_LLVMBPFDesc",
            "@llvm_linux//:lib_LLVMBPFInfo",
            "@llvm_linux//:lib_LLVMBPFAsmPrinter",
            "@llvm_linux//:lib_LLVMARMDisassembler",
            "@llvm_linux//:lib_LLVMARMCodeGen",
            "@llvm_linux//:lib_LLVMARMAsmParser",
            "@llvm_linux//:lib_LLVMARMDesc",
            "@llvm_linux//:lib_LLVMARMInfo",
            "@llvm_linux//:lib_LLVMARMAsmPrinter",
            "@llvm_linux//:lib_LLVMARMUtils",
            "@llvm_linux//:lib_LLVMAMDGPUDisassembler",
            "@llvm_linux//:lib_LLVMAMDGPUCodeGen",
            "@llvm_linux//:lib_LLVMAMDGPUAsmParser",
            "@llvm_linux//:lib_LLVMAMDGPUDesc",
            "@llvm_linux//:lib_LLVMAMDGPUInfo",
            "@llvm_linux//:lib_LLVMAMDGPUAsmPrinter",
            "@llvm_linux//:lib_LLVMAMDGPUUtils",
            "@llvm_linux//:lib_LLVMAArch64Disassembler",
            "@llvm_linux//:lib_LLVMAArch64CodeGen",
            "@llvm_linux//:lib_LLVMAArch64AsmParser",
            "@llvm_linux//:lib_LLVMAArch64Desc",
            "@llvm_linux//:lib_LLVMAArch64Info",
            "@llvm_linux//:lib_LLVMAArch64AsmPrinter",
            "@llvm_linux//:lib_LLVMAArch64Utils",
            "@llvm_linux//:lib_LLVMObjectYAML",
            "@llvm_linux//:lib_LLVMLibDriver",
            "@llvm_linux//:lib_LLVMOption",
            "@llvm_linux//:lib_LLVMWindowsManifest",
            "@llvm_linux//:lib_LLVMFuzzMutate",
            "@llvm_linux//:lib_LLVMX86Disassembler",
            "@llvm_linux//:lib_LLVMX86AsmParser",
            "@llvm_linux//:lib_LLVMX86CodeGen",
            "@llvm_linux//:lib_LLVMGlobalISel",
            "@llvm_linux//:lib_LLVMSelectionDAG",
            "@llvm_linux//:lib_LLVMAsmPrinter",
            "@llvm_linux//:lib_LLVMDebugInfoCodeView",
            "@llvm_linux//:lib_LLVMDebugInfoMSF",
            "@llvm_linux//:lib_LLVMX86Desc",
            "@llvm_linux//:lib_LLVMMCDisassembler",
            "@llvm_linux//:lib_LLVMX86Info",
            "@llvm_linux//:lib_LLVMX86AsmPrinter",
            "@llvm_linux//:lib_LLVMX86Utils",
            "@llvm_linux//:lib_LLVMMCJIT",
            "@llvm_linux//:lib_LLVMLineEditor",
            "@llvm_linux//:lib_LLVMInterpreter",
            "@llvm_linux//:lib_LLVMExecutionEngine",
            "@llvm_linux//:lib_LLVMRuntimeDyld",
            "@llvm_linux//:lib_LLVMCodeGen",
            "@llvm_linux//:lib_LLVMTarget",
            "@llvm_linux//:lib_LLVMCoroutines",
            "@llvm_linux//:lib_LLVMipo",
            "@llvm_linux//:lib_LLVMInstrumentation",
            "@llvm_linux//:lib_LLVMVectorize",
            "@llvm_linux//:lib_LLVMScalarOpts",
            "@llvm_linux//:lib_LLVMLinker",
            "@llvm_linux//:lib_LLVMIRReader",
            "@llvm_linux//:lib_LLVMAsmParser",
            "@llvm_linux//:lib_LLVMInstCombine",
            "@llvm_linux//:lib_LLVMTransformUtils",
            "@llvm_linux//:lib_LLVMBitWriter",
            "@llvm_linux//:lib_LLVMAnalysis",
            "@llvm_linux//:lib_LLVMProfileData",
            "@llvm_linux//:lib_LLVMObject",
            "@llvm_linux//:lib_LLVMMCParser",
            "@llvm_linux//:lib_LLVMMC",
            "@llvm_linux//:lib_LLVMBitReader",
            "@llvm_linux//:lib_LLVMCore",
            "@llvm_linux//:lib_LLVMBinaryFormat",
            "@llvm_linux//:lib_LLVMSupport",
            "@llvm_linux//:lib_LLVMDemangle",
        ],
    }),
    linkopts = select({
        "//:darwin": [
            "-Wl,-rpath,$(location @llvm_mac//:libdir)/",
            "-L$(location @llvm_mac//:libdir)/",
        ],
        "//conditions:default": [
            "-Wl,-rpath,$(location @llvm_linux//:libdir)/",
            "-L$(location @llvm_linux//:libdir)/",
        ],
    }) + [
        # TODO(cec): I expect that this list can be pruned somewhat.
        "-pthread",
        "-ldl",
        "-lz",
        "-lclangARCMigrate",
        "-lclangFrontend",
        "-lclangFrontendTool",
        "-lclangDriver",
        "-lclangSerialization",
        "-lclangCodeGen",
        "-lclangParse",
        "-lclangSema",
        "-lclangRewriteFrontend",
        "-lclangRewrite",
        "-lclangStaticAnalyzerFrontend",
        "-lclangStaticAnalyzerCheckers",
        "-lclangStaticAnalyzerCore",
        "-lclangAnalysis",
        "-lclangEdit",
        "-lclangAST",
        "-lclangASTMatchers",
        "-lclangLex",
        "-lclangBasic",
        "-lclangTooling",
        "-lclangToolingCore",
    ] + select({
        "//:darwin": [],
        "//conditions:default": ["-lclang"],
    }) + [
        "-lLLVMLTO",
        "-lLLVMPasses",
        "-lLLVMObjCARCOpts",
        "-lLLVMMIRParser",
        "-lLLVMSymbolize",
        "-lLLVMDebugInfoPDB",
        "-lLLVMDebugInfoDWARF",
        "-lLLVMCoverage",
        "-lLLVMTableGen",
        "-lLLVMDlltoolDriver",
        "-lLLVMOrcJIT",
        "-lLLVMXCoreDisassembler",
        "-lLLVMXCoreCodeGen",
        "-lLLVMXCoreDesc",
        "-lLLVMXCoreInfo",
        "-lLLVMXCoreAsmPrinter",
        "-lLLVMSystemZDisassembler",
        "-lLLVMSystemZCodeGen",
        "-lLLVMSystemZAsmParser",
        "-lLLVMSystemZDesc",
        "-lLLVMSystemZInfo",
        "-lLLVMSystemZAsmPrinter",
        "-lLLVMSparcDisassembler",
        "-lLLVMSparcCodeGen",
        "-lLLVMSparcAsmParser",
        "-lLLVMSparcDesc",
        "-lLLVMSparcInfo",
        "-lLLVMSparcAsmPrinter",
        "-lLLVMPowerPCDisassembler",
        "-lLLVMPowerPCCodeGen",
        "-lLLVMPowerPCAsmParser",
        "-lLLVMPowerPCDesc",
        "-lLLVMPowerPCInfo",
        "-lLLVMPowerPCAsmPrinter",
        "-lLLVMNVPTXCodeGen",
        "-lLLVMNVPTXDesc",
        "-lLLVMNVPTXInfo",
        "-lLLVMNVPTXAsmPrinter",
        "-lLLVMMSP430CodeGen",
        "-lLLVMMSP430Desc",
        "-lLLVMMSP430Info",
        "-lLLVMMSP430AsmPrinter",
        "-lLLVMMipsDisassembler",
        "-lLLVMMipsCodeGen",
        "-lLLVMMipsAsmParser",
        "-lLLVMMipsDesc",
        "-lLLVMMipsInfo",
        "-lLLVMMipsAsmPrinter",
        "-lLLVMLanaiDisassembler",
        "-lLLVMLanaiCodeGen",
        "-lLLVMLanaiAsmParser",
        "-lLLVMLanaiDesc",
        "-lLLVMLanaiAsmPrinter",
        "-lLLVMLanaiInfo",
        "-lLLVMHexagonDisassembler",
        "-lLLVMHexagonCodeGen",
        "-lLLVMHexagonAsmParser",
        "-lLLVMHexagonDesc",
        "-lLLVMHexagonInfo",
        "-lLLVMBPFDisassembler",
        "-lLLVMBPFCodeGen",
        "-lLLVMBPFAsmParser",
        "-lLLVMBPFDesc",
        "-lLLVMBPFInfo",
        "-lLLVMBPFAsmPrinter",
        "-lLLVMARMDisassembler",
        "-lLLVMARMCodeGen",
        "-lLLVMARMAsmParser",
        "-lLLVMARMDesc",
        "-lLLVMARMInfo",
        "-lLLVMARMAsmPrinter",
        "-lLLVMARMUtils",
        "-lLLVMAMDGPUDisassembler",
        "-lLLVMAMDGPUCodeGen",
        "-lLLVMAMDGPUAsmParser",
        "-lLLVMAMDGPUDesc",
        "-lLLVMAMDGPUInfo",
        "-lLLVMAMDGPUAsmPrinter",
        "-lLLVMAMDGPUUtils",
        "-lLLVMAArch64Disassembler",
        "-lLLVMAArch64CodeGen",
        "-lLLVMAArch64AsmParser",
        "-lLLVMAArch64Desc",
        "-lLLVMAArch64Info",
        "-lLLVMAArch64AsmPrinter",
        "-lLLVMAArch64Utils",
        "-lLLVMObjectYAML",
        "-lLLVMLibDriver",
        "-lLLVMOption",
        "-lLLVMWindowsManifest",
        "-lLLVMFuzzMutate",
        "-lLLVMX86Disassembler",
        "-lLLVMX86AsmParser",
        "-lLLVMX86CodeGen",
        "-lLLVMGlobalISel",
        "-lLLVMSelectionDAG",
        "-lLLVMAsmPrinter",
        "-lLLVMDebugInfoCodeView",
        "-lLLVMDebugInfoMSF",
        "-lLLVMX86Desc",
        "-lLLVMMCDisassembler",
        "-lLLVMX86Info",
        "-lLLVMX86AsmPrinter",
        "-lLLVMX86Utils",
        "-lLLVMMCJIT",
        "-lLLVMLineEditor",
        "-lLLVMInterpreter",
        "-lLLVMExecutionEngine",
        "-lLLVMRuntimeDyld",
        "-lLLVMCodeGen",
        "-lLLVMTarget",
        "-lLLVMCoroutines",
        "-lLLVMipo",
        "-lLLVMInstrumentation",
        "-lLLVMVectorize",
        "-lLLVMScalarOpts",
        "-lLLVMLinker",
        "-lLLVMIRReader",
        "-lLLVMAsmParser",
        "-lLLVMInstCombine",
        "-lLLVMTransformUtils",
        "-lLLVMBitWriter",
        "-lLLVMAnalysis",
        "-lLLVMProfileData",
        "-lLLVMObject",
        "-lLLVMMCParser",
        "-lLLVMMC",
        "-lLLVMBitReader",
        "-lLLVMCore",
        "-lLLVMBinaryFormat",
        "-lLLVMSupport",
        "-lLLVMDemangle",
    ] + select({
        "//:darwin": ["-lncurses"],
        "//conditions:default": [],
    }),
    visibility = ["//deeplearning/clgen:__subpackages__"],
    deps = select({
        "//:darwin": [
            "@llvm_headers_mac//:headers",
            "@llvm_mac//:libs",
        ],
        "//conditions:default": [
            "@llvm_headers_linux//:headers",
            "@llvm_linux//:libs",
        ],
    }),
)

cc_binary(
    name = "clgen-rewriter",
    srcs = ["clgen-rewriter.cpp"],
    copts = [
        "-fPIC",
        "-fvisibility-inlines-hidden",
        "-Werror=date-time",
        "-std=c++11",
        "-Wall",
        "-W",
        "-Wno-unused-parameter",
        "-Wwrite-strings",
        "-Wcast-qual",
        "-Wno-missing-field-initializers",
        "-pedantic",
        "-Wno-long-long",
        "-Wdelete-non-virtual-dtor",
        "-Wno-comment",
        "-fno-rtti",
        "-ffunction-sections",
        "-fdata-sections",
        "-DNDEBUG",
        "-D_GNU_SOURCE",
        "-D__STDC_CONSTANT_MACROS",
        "-D__STDC_FORMAT_MACROS",
        "-D__STDC_LIMIT_MACROS",
    ],
    data = select({
        "//:darwin": [
            "@llvm_mac//:libdir",
            "@llvm_mac//:lib_clangARCMigrate",
            "@llvm_mac//:lib_clangFrontend",
            "@llvm_mac//:lib_clangFrontendTool",
            "@llvm_mac//:lib_clangDriver",
            "@llvm_mac//:lib_clangSerialization",
            "@llvm_mac//:lib_clangCodeGen",
            "@llvm_mac//:lib_clangParse",
            "@llvm_mac//:lib_clangSema",
            "@llvm_mac//:lib_clangRewriteFrontend",
            "@llvm_mac//:lib_clangRewrite",
            "@llvm_mac//:lib_clangStaticAnalyzerFrontend",
            "@llvm_mac//:lib_clangStaticAnalyzerCheckers",
            "@llvm_mac//:lib_clangStaticAnalyzerCore",
            "@llvm_mac//:lib_clangAnalysis",
            "@llvm_mac//:lib_clangEdit",
            "@llvm_mac//:lib_clangAST",
            "@llvm_mac//:lib_clangASTMatchers",
            "@llvm_mac//:lib_clangLex",
            "@llvm_mac//:lib_clangBasic",
            "@llvm_mac//:lib_clangTooling",
            "@llvm_mac//:lib_clangToolingCore",
            "@llvm_mac//:lib_LLVMLTO",
            "@llvm_mac//:lib_LLVMPasses",
            "@llvm_mac//:lib_LLVMObjCARCOpts",
            "@llvm_mac//:lib_LLVMMIRParser",
            "@llvm_mac//:lib_LLVMSymbolize",
            "@llvm_mac//:lib_LLVMDebugInfoPDB",
            "@llvm_mac//:lib_LLVMDebugInfoDWARF",
            "@llvm_mac//:lib_LLVMCoverage",
            "@llvm_mac//:lib_LLVMTableGen",
            "@llvm_mac//:lib_LLVMDlltoolDriver",
            "@llvm_mac//:lib_LLVMOrcJIT",
            "@llvm_mac//:lib_LLVMXCoreDisassembler",
            "@llvm_mac//:lib_LLVMXCoreCodeGen",
            "@llvm_mac//:lib_LLVMXCoreDesc",
            "@llvm_mac//:lib_LLVMXCoreInfo",
            "@llvm_mac//:lib_LLVMXCoreAsmPrinter",
            "@llvm_mac//:lib_LLVMSystemZDisassembler",
            "@llvm_mac//:lib_LLVMSystemZCodeGen",
            "@llvm_mac//:lib_LLVMSystemZAsmParser",
            "@llvm_mac//:lib_LLVMSystemZDesc",
            "@llvm_mac//:lib_LLVMSystemZInfo",
            "@llvm_mac//:lib_LLVMSystemZAsmPrinter",
            "@llvm_mac//:lib_LLVMSparcDisassembler",
            "@llvm_mac//:lib_LLVMSparcCodeGen",
            "@llvm_mac//:lib_LLVMSparcAsmParser",
            "@llvm_mac//:lib_LLVMSparcDesc",
            "@llvm_mac//:lib_LLVMSparcInfo",
            "@llvm_mac//:lib_LLVMSparcAsmPrinter",
            "@llvm_mac//:lib_LLVMPowerPCDisassembler",
            "@llvm_mac//:lib_LLVMPowerPCCodeGen",
            "@llvm_mac//:lib_LLVMPowerPCAsmParser",
            "@llvm_mac//:lib_LLVMPowerPCDesc",
            "@llvm_mac//:lib_LLVMPowerPCInfo",
            "@llvm_mac//:lib_LLVMPowerPCAsmPrinter",
            "@llvm_mac//:lib_LLVMNVPTXCodeGen",
            "@llvm_mac//:lib_LLVMNVPTXDesc",
            "@llvm_mac//:lib_LLVMNVPTXInfo",
            "@llvm_mac//:lib_LLVMNVPTXAsmPrinter",
            "@llvm_mac//:lib_LLVMMSP430CodeGen",
            "@llvm_mac//:lib_LLVMMSP430Desc",
            "@llvm_mac//:lib_LLVMMSP430Info",
            "@llvm_mac//:lib_LLVMMSP430AsmPrinter",
            "@llvm_mac//:lib_LLVMMipsDisassembler",
            "@llvm_mac//:lib_LLVMMipsCodeGen",
            "@llvm_mac//:lib_LLVMMipsAsmParser",
            "@llvm_mac//:lib_LLVMMipsDesc",
            "@llvm_mac//:lib_LLVMMipsInfo",
            "@llvm_mac//:lib_LLVMMipsAsmPrinter",
            "@llvm_mac//:lib_LLVMLanaiDisassembler",
            "@llvm_mac//:lib_LLVMLanaiCodeGen",
            "@llvm_mac//:lib_LLVMLanaiAsmParser",
            "@llvm_mac//:lib_LLVMLanaiDesc",
            "@llvm_mac//:lib_LLVMLanaiAsmPrinter",
            "@llvm_mac//:lib_LLVMLanaiInfo",
            "@llvm_mac//:lib_LLVMHexagonDisassembler",
            "@llvm_mac//:lib_LLVMHexagonCodeGen",
            "@llvm_mac//:lib_LLVMHexagonAsmParser",
            "@llvm_mac//:lib_LLVMHexagonDesc",
            "@llvm_mac//:lib_LLVMHexagonInfo",
            "@llvm_mac//:lib_LLVMBPFDisassembler",
            "@llvm_mac//:lib_LLVMBPFCodeGen",
            "@llvm_mac//:lib_LLVMBPFAsmParser",
            "@llvm_mac//:lib_LLVMBPFDesc",
            "@llvm_mac//:lib_LLVMBPFInfo",
            "@llvm_mac//:lib_LLVMBPFAsmPrinter",
            "@llvm_mac//:lib_LLVMARMDisassembler",
            "@llvm_mac//:lib_LLVMARMCodeGen",
            "@llvm_mac//:lib_LLVMARMAsmParser",
            "@llvm_mac//:lib_LLVMARMDesc",
            "@llvm_mac//:lib_LLVMARMInfo",
            "@llvm_mac//:lib_LLVMARMAsmPrinter",
            "@llvm_mac//:lib_LLVMARMUtils",
            "@llvm_mac//:lib_LLVMAMDGPUDisassembler",
            "@llvm_mac//:lib_LLVMAMDGPUCodeGen",
            "@llvm_mac//:lib_LLVMAMDGPUAsmParser",
            "@llvm_mac//:lib_LLVMAMDGPUDesc",
            "@llvm_mac//:lib_LLVMAMDGPUInfo",
            "@llvm_mac//:lib_LLVMAMDGPUAsmPrinter",
            "@llvm_mac//:lib_LLVMAMDGPUUtils",
            "@llvm_mac//:lib_LLVMAArch64Disassembler",
            "@llvm_mac//:lib_LLVMAArch64CodeGen",
            "@llvm_mac//:lib_LLVMAArch64AsmParser",
            "@llvm_mac//:lib_LLVMAArch64Desc",
            "@llvm_mac//:lib_LLVMAArch64Info",
            "@llvm_mac//:lib_LLVMAArch64AsmPrinter",
            "@llvm_mac//:lib_LLVMAArch64Utils",
            "@llvm_mac//:lib_LLVMObjectYAML",
            "@llvm_mac//:lib_LLVMLibDriver",
            "@llvm_mac//:lib_LLVMOption",
            "@llvm_mac//:lib_LLVMWindowsManifest",
            "@llvm_mac//:lib_LLVMFuzzMutate",
            "@llvm_mac//:lib_LLVMX86Disassembler",
            "@llvm_mac//:lib_LLVMX86AsmParser",
            "@llvm_mac//:lib_LLVMX86CodeGen",
            "@llvm_mac//:lib_LLVMGlobalISel",
            "@llvm_mac//:lib_LLVMSelectionDAG",
            "@llvm_mac//:lib_LLVMAsmPrinter",
            "@llvm_mac//:lib_LLVMDebugInfoCodeView",
            "@llvm_mac//:lib_LLVMDebugInfoMSF",
            "@llvm_mac//:lib_LLVMX86Desc",
            "@llvm_mac//:lib_LLVMMCDisassembler",
            "@llvm_mac//:lib_LLVMX86Info",
            "@llvm_mac//:lib_LLVMX86AsmPrinter",
            "@llvm_mac//:lib_LLVMX86Utils",
            "@llvm_mac//:lib_LLVMMCJIT",
            "@llvm_mac//:lib_LLVMLineEditor",
            "@llvm_mac//:lib_LLVMInterpreter",
            "@llvm_mac//:lib_LLVMExecutionEngine",
            "@llvm_mac//:lib_LLVMRuntimeDyld",
            "@llvm_mac//:lib_LLVMCodeGen",
            "@llvm_mac//:lib_LLVMTarget",
            "@llvm_mac//:lib_LLVMCoroutines",
            "@llvm_mac//:lib_LLVMipo",
            "@llvm_mac//:lib_LLVMInstrumentation",
            "@llvm_mac//:lib_LLVMVectorize",
            "@llvm_mac//:lib_LLVMScalarOpts",
            "@llvm_mac//:lib_LLVMLinker",
            "@llvm_mac//:lib_LLVMIRReader",
            "@llvm_mac//:lib_LLVMAsmParser",
            "@llvm_mac//:lib_LLVMInstCombine",
            "@llvm_mac//:lib_LLVMTransformUtils",
            "@llvm_mac//:lib_LLVMBitWriter",
            "@llvm_mac//:lib_LLVMAnalysis",
            "@llvm_mac//:lib_LLVMProfileData",
            "@llvm_mac//:lib_LLVMObject",
            "@llvm_mac//:lib_LLVMMCParser",
            "@llvm_mac//:lib_LLVMMC",
            "@llvm_mac//:lib_LLVMBitReader",
            "@llvm_mac//:lib_LLVMCore",
            "@llvm_mac//:lib_LLVMBinaryFormat",
            "@llvm_mac//:lib_LLVMSupport",
            "@llvm_mac//:lib_LLVMDemangle",
        ],
        "//conditions:default": [
            "@llvm_linux//:libclang_so",
            "@llvm_linux//:libdir",
            "@llvm_linux//:lib_clangARCMigrate",
            "@llvm_linux//:lib_clangFrontend",
            "@llvm_linux//:lib_clangFrontendTool",
            "@llvm_linux//:lib_clangDriver",
            "@llvm_linux//:lib_clangSerialization",
            "@llvm_linux//:lib_clangCodeGen",
            "@llvm_linux//:lib_clangParse",
            "@llvm_linux//:lib_clangSema",
            "@llvm_linux//:lib_clangRewriteFrontend",
            "@llvm_linux//:lib_clangRewrite",
            "@llvm_linux//:lib_clangStaticAnalyzerFrontend",
            "@llvm_linux//:lib_clangStaticAnalyzerCheckers",
            "@llvm_linux//:lib_clangStaticAnalyzerCore",
            "@llvm_linux//:lib_clangAnalysis",
            "@llvm_linux//:lib_clangEdit",
            "@llvm_linux//:lib_clangAST",
            "@llvm_linux//:lib_clangASTMatchers",
            "@llvm_linux//:lib_clangLex",
            "@llvm_linux//:lib_clangBasic",
            "@llvm_linux//:lib_clangTooling",
            "@llvm_linux//:lib_clangToolingCore",
            "@llvm_linux//:lib_LLVMLTO",
            "@llvm_linux//:lib_LLVMPasses",
            "@llvm_linux//:lib_LLVMObjCARCOpts",
            "@llvm_linux//:lib_LLVMMIRParser",
            "@llvm_linux//:lib_LLVMSymbolize",
            "@llvm_linux//:lib_LLVMDebugInfoPDB",
            "@llvm_linux//:lib_LLVMDebugInfoDWARF",
            "@llvm_linux//:lib_LLVMCoverage",
            "@llvm_linux//:lib_LLVMTableGen",
            "@llvm_linux//:lib_LLVMDlltoolDriver",
            "@llvm_linux//:lib_LLVMOrcJIT",
            "@llvm_linux//:lib_LLVMXCoreDisassembler",
            "@llvm_linux//:lib_LLVMXCoreCodeGen",
            "@llvm_linux//:lib_LLVMXCoreDesc",
            "@llvm_linux//:lib_LLVMXCoreInfo",
            "@llvm_linux//:lib_LLVMXCoreAsmPrinter",
            "@llvm_linux//:lib_LLVMSystemZDisassembler",
            "@llvm_linux//:lib_LLVMSystemZCodeGen",
            "@llvm_linux//:lib_LLVMSystemZAsmParser",
            "@llvm_linux//:lib_LLVMSystemZDesc",
            "@llvm_linux//:lib_LLVMSystemZInfo",
            "@llvm_linux//:lib_LLVMSystemZAsmPrinter",
            "@llvm_linux//:lib_LLVMSparcDisassembler",
            "@llvm_linux//:lib_LLVMSparcCodeGen",
            "@llvm_linux//:lib_LLVMSparcAsmParser",
            "@llvm_linux//:lib_LLVMSparcDesc",
            "@llvm_linux//:lib_LLVMSparcInfo",
            "@llvm_linux//:lib_LLVMSparcAsmPrinter",
            "@llvm_linux//:lib_LLVMPowerPCDisassembler",
            "@llvm_linux//:lib_LLVMPowerPCCodeGen",
            "@llvm_linux//:lib_LLVMPowerPCAsmParser",
            "@llvm_linux//:lib_LLVMPowerPCDesc",
            "@llvm_linux//:lib_LLVMPowerPCInfo",
            "@llvm_linux//:lib_LLVMPowerPCAsmPrinter",
            "@llvm_linux//:lib_LLVMNVPTXCodeGen",
            "@llvm_linux//:lib_LLVMNVPTXDesc",
            "@llvm_linux//:lib_LLVMNVPTXInfo",
            "@llvm_linux//:lib_LLVMNVPTXAsmPrinter",
            "@llvm_linux//:lib_LLVMMSP430CodeGen",
            "@llvm_linux//:lib_LLVMMSP430Desc",
            "@llvm_linux//:lib_LLVMMSP430Info",
            "@llvm_linux//:lib_LLVMMSP430AsmPrinter",
            "@llvm_linux//:lib_LLVMMipsDisassembler",
            "@llvm_linux//:lib_LLVMMipsCodeGen",
            "@llvm_linux//:lib_LLVMMipsAsmParser",
            "@llvm_linux//:lib_LLVMMipsDesc",
            "@llvm_linux//:lib_LLVMMipsInfo",
            "@llvm_linux//:lib_LLVMMipsAsmPrinter",
            "@llvm_linux//:lib_LLVMLanaiDisassembler",
            "@llvm_linux//:lib_LLVMLanaiCodeGen",
            "@llvm_linux//:lib_LLVMLanaiAsmParser",
            "@llvm_linux//:lib_LLVMLanaiDesc",
            "@llvm_linux//:lib_LLVMLanaiAsmPrinter",
            "@llvm_linux//:lib_LLVMLanaiInfo",
            "@llvm_linux//:lib_LLVMHexagonDisassembler",
            "@llvm_linux//:lib_LLVMHexagonCodeGen",
            "@llvm_linux//:lib_LLVMHexagonAsmParser",
            "@llvm_linux//:lib_LLVMHexagonDesc",
            "@llvm_linux//:lib_LLVMHexagonInfo",
            "@llvm_linux//:lib_LLVMBPFDisassembler",
            "@llvm_linux//:lib_LLVMBPFCodeGen",
            "@llvm_linux//:lib_LLVMBPFAsmParser",
            "@llvm_linux//:lib_LLVMBPFDesc",
            "@llvm_linux//:lib_LLVMBPFInfo",
            "@llvm_linux//:lib_LLVMBPFAsmPrinter",
            "@llvm_linux//:lib_LLVMARMDisassembler",
            "@llvm_linux//:lib_LLVMARMCodeGen",
            "@llvm_linux//:lib_LLVMARMAsmParser",
            "@llvm_linux//:lib_LLVMARMDesc",
            "@llvm_linux//:lib_LLVMARMInfo",
            "@llvm_linux//:lib_LLVMARMAsmPrinter",
            "@llvm_linux//:lib_LLVMARMUtils",
            "@llvm_linux//:lib_LLVMAMDGPUDisassembler",
            "@llvm_linux//:lib_LLVMAMDGPUCodeGen",
            "@llvm_linux//:lib_LLVMAMDGPUAsmParser",
            "@llvm_linux//:lib_LLVMAMDGPUDesc",
            "@llvm_linux//:lib_LLVMAMDGPUInfo",
            "@llvm_linux//:lib_LLVMAMDGPUAsmPrinter",
            "@llvm_linux//:lib_LLVMAMDGPUUtils",
            "@llvm_linux//:lib_LLVMAArch64Disassembler",
            "@llvm_linux//:lib_LLVMAArch64CodeGen",
            "@llvm_linux//:lib_LLVMAArch64AsmParser",
            "@llvm_linux//:lib_LLVMAArch64Desc",
            "@llvm_linux//:lib_LLVMAArch64Info",
            "@llvm_linux//:lib_LLVMAArch64AsmPrinter",
            "@llvm_linux//:lib_LLVMAArch64Utils",
            "@llvm_linux//:lib_LLVMObjectYAML",
            "@llvm_linux//:lib_LLVMLibDriver",
            "@llvm_linux//:lib_LLVMOption",
            "@llvm_linux//:lib_LLVMWindowsManifest",
            "@llvm_linux//:lib_LLVMFuzzMutate",
            "@llvm_linux//:lib_LLVMX86Disassembler",
            "@llvm_linux//:lib_LLVMX86AsmParser",
            "@llvm_linux//:lib_LLVMX86CodeGen",
            "@llvm_linux//:lib_LLVMGlobalISel",
            "@llvm_linux//:lib_LLVMSelectionDAG",
            "@llvm_linux//:lib_LLVMAsmPrinter",
            "@llvm_linux//:lib_LLVMDebugInfoCodeView",
            "@llvm_linux//:lib_LLVMDebugInfoMSF",
            "@llvm_linux//:lib_LLVMX86Desc",
            "@llvm_linux//:lib_LLVMMCDisassembler",
            "@llvm_linux//:lib_LLVMX86Info",
            "@llvm_linux//:lib_LLVMX86AsmPrinter",
            "@llvm_linux//:lib_LLVMX86Utils",
            "@llvm_linux//:lib_LLVMMCJIT",
            "@llvm_linux//:lib_LLVMLineEditor",
            "@llvm_linux//:lib_LLVMInterpreter",
            "@llvm_linux//:lib_LLVMExecutionEngine",
            "@llvm_linux//:lib_LLVMRuntimeDyld",
            "@llvm_linux//:lib_LLVMCodeGen",
            "@llvm_linux//:lib_LLVMTarget",
            "@llvm_linux//:lib_LLVMCoroutines",
            "@llvm_linux//:lib_LLVMipo",
            "@llvm_linux//:lib_LLVMInstrumentation",
            "@llvm_linux//:lib_LLVMVectorize",
            "@llvm_linux//:lib_LLVMScalarOpts",
            "@llvm_linux//:lib_LLVMLinker",
            "@llvm_linux//:lib_LLVMIRReader",
            "@llvm_linux//:lib_LLVMAsmParser",
            "@llvm_linux//:lib_LLVMInstCombine",
            "@llvm_linux//:lib_LLVMTransformUtils",
            "@llvm_linux//:lib_LLVMBitWriter",
            "@llvm_linux//:lib_LLVMAnalysis",
            "@llvm_linux//:lib_LLVMProfileData",
            "@llvm_linux//:lib_LLVMObject",
            "@llvm_linux//:lib_LLVMMCParser",
            "@llvm_linux//:lib_LLVMMC",
            "@llvm_linux//:lib_LLVMBitReader",
            "@llvm_linux//:lib_LLVMCore",
            "@llvm_linux//:lib_LLVMBinaryFormat",
            "@llvm_linux//:lib_LLVMSupport",
            "@llvm_linux//:lib_LLVMDemangle",
        ],
    }),
    linkopts = select({
        "//:darwin": [
            "-Wl,-rpath,$(location @llvm_mac//:libdir)/",
            "-L$(location @llvm_mac//:libdir)/",
        ],
        "//conditions:default": [
            "-Wl,-rpath,$(location @llvm_linux//:libdir)/",
            "-L$(location @llvm_linux//:libdir)/",
        ],
    }) + [
        # TODO(cec): I expect that this list can be pruned somewhat.
        "-pthread",
        "-ldl",
        "-lz",
        "-lclangARCMigrate",
        "-lclangFrontend",
        "-lclangFrontendTool",
        "-lclangDriver",
        "-lclangSerialization",
        "-lclangCodeGen",
        "-lclangParse",
        "-lclangSema",
        "-lclangRewriteFrontend",
        "-lclangRewrite",
        "-lclangStaticAnalyzerFrontend",
        "-lclangStaticAnalyzerCheckers",
        "-lclangStaticAnalyzerCore",
        "-lclangAnalysis",
        "-lclangEdit",
        "-lclangAST",
        "-lclangASTMatchers",
        "-lclangLex",
        "-lclangBasic",
        "-lclangTooling",
        "-lclangToolingCore",
    ] + select({
        "//:darwin": [],
        "//conditions:default": ["-lclang"],
    }) + [
        "-lLLVMLTO",
        "-lLLVMPasses",
        "-lLLVMObjCARCOpts",
        "-lLLVMMIRParser",
        "-lLLVMSymbolize",
        "-lLLVMDebugInfoPDB",
        "-lLLVMDebugInfoDWARF",
        "-lLLVMCoverage",
        "-lLLVMTableGen",
        "-lLLVMDlltoolDriver",
        "-lLLVMOrcJIT",
        "-lLLVMXCoreDisassembler",
        "-lLLVMXCoreCodeGen",
        "-lLLVMXCoreDesc",
        "-lLLVMXCoreInfo",
        "-lLLVMXCoreAsmPrinter",
        "-lLLVMSystemZDisassembler",
        "-lLLVMSystemZCodeGen",
        "-lLLVMSystemZAsmParser",
        "-lLLVMSystemZDesc",
        "-lLLVMSystemZInfo",
        "-lLLVMSystemZAsmPrinter",
        "-lLLVMSparcDisassembler",
        "-lLLVMSparcCodeGen",
        "-lLLVMSparcAsmParser",
        "-lLLVMSparcDesc",
        "-lLLVMSparcInfo",
        "-lLLVMSparcAsmPrinter",
        "-lLLVMPowerPCDisassembler",
        "-lLLVMPowerPCCodeGen",
        "-lLLVMPowerPCAsmParser",
        "-lLLVMPowerPCDesc",
        "-lLLVMPowerPCInfo",
        "-lLLVMPowerPCAsmPrinter",
        "-lLLVMNVPTXCodeGen",
        "-lLLVMNVPTXDesc",
        "-lLLVMNVPTXInfo",
        "-lLLVMNVPTXAsmPrinter",
        "-lLLVMMSP430CodeGen",
        "-lLLVMMSP430Desc",
        "-lLLVMMSP430Info",
        "-lLLVMMSP430AsmPrinter",
        "-lLLVMMipsDisassembler",
        "-lLLVMMipsCodeGen",
        "-lLLVMMipsAsmParser",
        "-lLLVMMipsDesc",
        "-lLLVMMipsInfo",
        "-lLLVMMipsAsmPrinter",
        "-lLLVMLanaiDisassembler",
        "-lLLVMLanaiCodeGen",
        "-lLLVMLanaiAsmParser",
        "-lLLVMLanaiDesc",
        "-lLLVMLanaiAsmPrinter",
        "-lLLVMLanaiInfo",
        "-lLLVMHexagonDisassembler",
        "-lLLVMHexagonCodeGen",
        "-lLLVMHexagonAsmParser",
        "-lLLVMHexagonDesc",
        "-lLLVMHexagonInfo",
        "-lLLVMBPFDisassembler",
        "-lLLVMBPFCodeGen",
        "-lLLVMBPFAsmParser",
        "-lLLVMBPFDesc",
        "-lLLVMBPFInfo",
        "-lLLVMBPFAsmPrinter",
        "-lLLVMARMDisassembler",
        "-lLLVMARMCodeGen",
        "-lLLVMARMAsmParser",
        "-lLLVMARMDesc",
        "-lLLVMARMInfo",
        "-lLLVMARMAsmPrinter",
        "-lLLVMARMUtils",
        "-lLLVMAMDGPUDisassembler",
        "-lLLVMAMDGPUCodeGen",
        "-lLLVMAMDGPUAsmParser",
        "-lLLVMAMDGPUDesc",
        "-lLLVMAMDGPUInfo",
        "-lLLVMAMDGPUAsmPrinter",
        "-lLLVMAMDGPUUtils",
        "-lLLVMAArch64Disassembler",
        "-lLLVMAArch64CodeGen",
        "-lLLVMAArch64AsmParser",
        "-lLLVMAArch64Desc",
        "-lLLVMAArch64Info",
        "-lLLVMAArch64AsmPrinter",
        "-lLLVMAArch64Utils",
        "-lLLVMObjectYAML",
        "-lLLVMLibDriver",
        "-lLLVMOption",
        "-lLLVMWindowsManifest",
        "-lLLVMFuzzMutate",
        "-lLLVMX86Disassembler",
        "-lLLVMX86AsmParser",
        "-lLLVMX86CodeGen",
        "-lLLVMGlobalISel",
        "-lLLVMSelectionDAG",
        "-lLLVMAsmPrinter",
        "-lLLVMDebugInfoCodeView",
        "-lLLVMDebugInfoMSF",
        "-lLLVMX86Desc",
        "-lLLVMMCDisassembler",
        "-lLLVMX86Info",
        "-lLLVMX86AsmPrinter",
        "-lLLVMX86Utils",
        "-lLLVMMCJIT",
        "-lLLVMLineEditor",
        "-lLLVMInterpreter",
        "-lLLVMExecutionEngine",
        "-lLLVMRuntimeDyld",
        "-lLLVMCodeGen",
        "-lLLVMTarget",
        "-lLLVMCoroutines",
        "-lLLVMipo",
        "-lLLVMInstrumentation",
        "-lLLVMVectorize",
        "-lLLVMScalarOpts",
        "-lLLVMLinker",
        "-lLLVMIRReader",
        "-lLLVMAsmParser",
        "-lLLVMInstCombine",
        "-lLLVMTransformUtils",
        "-lLLVMBitWriter",
        "-lLLVMAnalysis",
        "-lLLVMProfileData",
        "-lLLVMObject",
        "-lLLVMMCParser",
        "-lLLVMMC",
        "-lLLVMBitReader",
        "-lLLVMCore",
        "-lLLVMBinaryFormat",
        "-lLLVMSupport",
        "-lLLVMDemangle",
    ] + select({
        "//:darwin": ["-lncurses"],
        "//conditions:default": [],
    }),
    visibility = ["//deeplearning/clgen:__subpackages__"],
    deps = select({
        "//:darwin": [
            "@llvm_headers_mac//:headers",
            "@llvm_mac//:libs",
        ],
        "//conditions:default": [
            "@llvm_headers_linux//:headers",
            "@llvm_linux//:libs",
        ],
    }),
)
