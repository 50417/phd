#!/usr/bin/env python3
#
# Download all of the OpenCL on GitHub (!)
#
# Shortcomings of this appraoch:
#
#   Only includes 'actual' OpenCL files, no inline strings
#
import smith
from smith import fetch

from argparse import ArgumentParser
from os import environ

def main():
    parser = ArgumentParser()
    parser.add_argument('input', help='path to SQL input dataset')
    args = parser.parse_args()

    db_path = args.input

    try:
        github_username = environ['GITHUB_USERNAME']
        github_pw = environ['GITHUB_PW']
        github_token = environ['GITHUB_TOKEN']
    except KeyError as e:
        print('fatal: environment variable {} not set'.format(e))
        sys.exit(1)

    fetch.github(db_path, github_username, github_pw, github_token)


if __name__ == '__main__':
    main()
